<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Piece Multiplication Quest</title>
    <style>
        body {
            font-family: 'Trebuchet MS', sans-serif;
            background-color: #0077be; /* Ocean blue color */
            color: #f8cb57; /* Straw Hat yellow */
            margin: 0;
            padding: 0;
            min-height: 100vh;
            background-image: url('/api/placeholder/800/400');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            color: #f8cb57; /* Straw Hat yellow */
            text-shadow: 2px 2px 4px #000;
            font-size: 2.5rem;
            font-weight: bold;
        }
        
        .strawhat-icon {
            font-size: 1.5rem;
            margin: 0 5px;
        }
        
        .quest-area {
            background-color: rgba(139, 69, 19, 0.85); /* Brown like a treasure map */
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            border: 3px solid #f8cb57; /* Straw Hat yellow border */
            margin-bottom: 20px;
        }
        
        .controls {
            margin: 20px 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .pirate-button {
            background-color: #d53032; /* Luffy's vest color */
            color: #f8cb57; /* Straw Hat yellow */
            border: 2px solid #f8cb57;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        
        .pirate-button:hover {
            background-color: #a12c1e;
            transform: scale(1.05);
        }
        
        .question-card {
            background-color: rgba(248, 203, 87, 0.9); /* Straw Hat yellow */
            color: #0077be; /* Ocean blue */
            border-radius: 10px;
            padding: 30px;
            margin: 20px auto;
            max-width: 500px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            position: relative;
            border: 2px solid #d53032; /* Luffy's vest color */
        }
        
        .character-area {
            margin-bottom: 15px;
        }
        
        .character-name {
            font-weight: bold;
            font-size: 1.2rem;
            color: #d53032; /* Luffy's vest color */
        }
        
        .multiplication {
            font-size: 3rem;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .options-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .option-button {
            background-color: #0077be; /* Ocean blue */
            color: #f8cb57; /* Straw Hat yellow */
            border: 2px solid #f8cb57;
            border-radius: 5px;
            padding: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .option-button:hover {
            background-color: #005c91;
            transform: scale(1.03);
        }
        
        .option-button.correct {
            background-color: #2ecc71; /* Green for correct */
            color: white;
            border-color: #27ae60;
        }
        
        .option-button.incorrect {
            background-color: #e74c3c; /* Red for incorrect */
            color: white;
            border-color: #c0392b;
        }
        
        .progress-map {
            position: relative;
            height: 80px;
            background-color: rgba(248, 203, 87, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .island {
            position: absolute;
            width: 30px;
            height: 30px;
            background-color: #8b4513;
            border-radius: 50%;
            top: 25px;
            transition: background-color 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #f8cb57;
            font-weight: bold;
        }
        
        .island.visited {
            background-color: #d53032;
        }
        
        .ship {
            position: absolute;
            width: 40px;
            height: 40px;
            top: 20px;
            transition: left 1s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            z-index: 2;
        }
        
        .path-line {
            position: absolute;
            height: 4px;
            background-color: #f8cb57;
            top: 38px;
            left: 30px;
            z-index: 1;
        }
        
        .stats {
            margin-top: 20px;
            display: flex;
            justify-content: space-around;
            background-color: rgba(0, 119, 190, 0.7);
            padding: 10px;
            border-radius: 10px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f8cb57;
        }
        
        .pirate-message {
            font-style: italic;
            margin-top: 20px;
            font-size: 1.2rem;
            min-height: 60px;
        }
        
        .result-message {
            font-weight: bold;
            margin-top: 10px;
            font-size: 1.2rem;
            min-height: 30px;
        }
        
        .hidden {
            display: none;
        }
        
        .end-screen {
            display: none;
            background-color: rgba(0, 119, 190, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 3px solid #f8cb57;
        }
        
        .end-screen h2 {
            color: #f8cb57;
            font-size: 2rem;
        }
        
        .end-screen.active {
            display: block;
        }
        
        @media (max-width: 600px) {
            .multiplication {
                font-size: 2.2rem;
            }
            
            .options-container {
                grid-template-columns: 1fr;
            }
            
            .option-button {
                font-size: 1.2rem;
                padding: 10px;
            }
            
            .progress-map {
                height: 60px;
            }
            
            .island {
                width: 20px;
                height: 20px;
                top: 20px;
            }
            
            .ship {
                width: 30px;
                height: 30px;
                top: 15px;
            }
            
            .path-line {
                top: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            <span class="strawhat-icon">üè¥‚Äç‚ò†Ô∏è</span>
            One Piece Multiplication Quest
            <span class="strawhat-icon">üè¥‚Äç‚ò†Ô∏è</span>
        </h1>
        
        <div class="quest-area">
            <p>Ahoy! Join the Straw Hat Pirates on their journey to find the One Piece! Solve multiplication problems to navigate from island to island on the Grand Line!</p>
            
            <div class="controls">
                <button id="start-btn" class="pirate-button">Start New Adventure</button>
                <button id="next-btn" class="pirate-button hidden">Next Island</button>
            </div>
            
            <div class="progress-map" id="progress-map">
                <div class="path-line" id="path-line"></div>
                <!-- Islands and ship will be added dynamically -->
            </div>
            
            <div class="question-card" id="question-card">
                <div class="character-area">
                    <div class="character-name" id="character-name">Monkey D. Luffy</div>
                </div>
                <div class="multiplication" id="problem">6 √ó 7 = ?</div>
                <div class="options-container" id="options-container">
                    <!-- Options will be generated here -->
                </div>
                <div class="result-message" id="result-message"></div>
            </div>
            
            <div class="stats">
                <div class="stat-item">
                    <div>Islands Visited</div>
                    <div class="stat-value" id="correct-count">0</div>
                </div>
                <div class="stat-item">
                    <div>Total Islands</div>
                    <div class="stat-value" id="total-count">10</div>
                </div>
                <div class="stat-item">
                    <div>Accuracy</div>
                    <div class="stat-value" id="accuracy">0%</div>
                </div>
            </div>
            
            <div class="pirate-message" id="pirate-message">
                "I'm gonna be King of the Multiplication Pirates!" - Monkey D. Luffy
            </div>
            
            <div class="end-screen" id="end-screen">
                <h2>Congratulations!</h2>
                <p>You've reached the final island and found the One Piece of multiplication knowledge!</p>
                <div id="final-stats"></div>
                <button id="restart-btn" class="pirate-button" style="margin-top: 20px;">Start New Adventure</button>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let currentProblemIndex = 0;
        let totalProblems = 10;
        let correctAnswers = 0;
        let totalAttempts = 0;
        let problems = [];
        let answered = false;
        
        const characters = [
            'Monkey D. Luffy', 
            'Roronoa Zoro', 
            'Nami', 
            'Usopp', 
            'Sanji', 
            'Tony Tony Chopper', 
            'Nico Robin', 
            'Franky', 
            'Brook', 
            'Jinbe'
        ];
        
        const onepiPhrases = [
            "I'm gonna be King of the Multiplication Pirates! - Luffy",
            "Getting lost in multiplication is just like my sense of direction... - Zoro",
            "I'll charge you 100,000 berries for each correct answer! - Nami",
            "I've mastered multiplication on all the islands of the Grand Line! - Usopp",
            "I'll cook up these multiplication problems with my Black Leg style! - Sanji",
            "Multiplying numbers is just like making medicine! - Chopper",
            "The history of multiplication is written in the Poneglyphs. - Robin",
            "These calculations are SUPER this week! - Franky",
            "Yohohoho! Solving these multiplication problems tickles my brain... though I don't have one! SKULL JOKE! - Brook",
            "Mastering multiplication is part of being a proper helmsman. - Jinbe"
        ];
        
        // Generate a random problem from 6-12 times tables
        function generateProblem() {
            const a = Math.floor(Math.random() * 7) + 6; // 6-12
            const b = Math.floor(Math.random() * 7) + 6; // 6-12
            const answer = a * b;
            
            // Generate 3 wrong answers that are close to the correct one
            const wrongAnswers = [];
            while (wrongAnswers.length < 3) {
                // Generate a number within ¬±10 of the correct answer, but not the answer itself
                let wrong = answer + Math.floor(Math.random() * 21) - 10;
                if (wrong !== answer && wrong > 0 && !wrongAnswers.includes(wrong)) {
                    wrongAnswers.push(wrong);
                }
            }
            
            // All 4 options (1 correct + 3 wrong)
            const options = [...wrongAnswers, answer];
            
            // Shuffle options
            for (let i = options.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [options[i], options[j]] = [options[j], options[i]];
            }
            
            return {
                a: a,
                b: b,
                answer: answer,
                options: options,
                character: characters[Math.floor(Math.random() * characters.length)]
            };
        }
        
        // Generate all problems for the quiz
        function generateAllProblems() {
            problems = [];
            for (let i = 0; i < totalProblems; i++) {
                problems.push(generateProblem());
            }
        }
        
        // Display the current problem
        function displayProblem() {
            if (currentProblemIndex >= totalProblems) {
                showEndScreen();
                return;
            }
            
            const problem = problems[currentProblemIndex];
            document.getElementById('problem').textContent = `${problem.a} √ó ${problem.b} = ?`;
            document.getElementById('character-name').textContent = problem.character;
            
            // Clear any previous options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            // Add the options
            problem.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = option;
                button.addEventListener('click', () => checkAnswer(option));
                optionsContainer.appendChild(button);
            });
            
            // Clear result message
            document.getElementById('result-message').textContent = '';
            
            // Update the pirate message
            const randomIndex = Math.floor(Math.random() * onepiPhrases.length);
            document.getElementById('pirate-message').textContent = `"${onepiPhrases[randomIndex]}"`;
            
            // Reset answered flag
            answered = false;
            
            // Show the next button if we're not on the first problem
            document.getElementById('next-btn').classList.toggle('hidden', currentProblemIndex === 0);
        }
        
        // Check the user's answer
        function checkAnswer(userAnswer) {
            if (answered) return; // Prevent multiple answers
            
            const problem = problems[currentProblemIndex];
            const isCorrect = userAnswer === problem.answer;
            
            // Mark the selected option as correct or incorrect
            const options = document.querySelectorAll('.option-button');
            options.forEach(option => {
                if (parseInt(option.textContent) === userAnswer) {
                    option.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                if (parseInt(option.textContent) === problem.answer && !isCorrect) {
                    // Highlight the correct answer if user got it wrong
                    option.classList.add('correct');
                }
                // Disable all options after an answer is selected
                option.disabled = true;
            });
            
            // Update stats
            totalAttempts++;
            if (isCorrect) {
                correctAnswers++;
                document.getElementById('result-message').textContent = 'Correct! You're a true pirate!';
                // Mark the current island as visited
                document.getElementById(`island-${currentProblemIndex}`).classList.add('visited');
                // Move the ship to the next island
                updateShipPosition(currentProblemIndex + 1);
            } else {
                document.getElementById('result-message').textContent = 'Incorrect! The correct answer is ' + problem.answer;
            }
            
            // Update display
            document.getElementById('correct-count').textContent = correctAnswers;
            const accuracyPercentage = totalAttempts > 0 ? Math.round((correctAnswers / totalAttempts) * 100) : 0;
            document.getElementById('accuracy').textContent = `${accuracyPercentage}%`;
            
            // Show next button
            document.getElementById('next-btn').classList.remove('hidden');
            
            // Mark as answered
            answered = true;
        }
        
        // Go to the next problem
        function nextProblem() {
            currentProblemIndex++;
            displayProblem();
        }
        
        // Show the end screen
        function showEndScreen() {
            document.getElementById('question-card').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');
            document.getElementById('end-screen').classList.add('active');
            
            const accuracyPercentage = totalAttempts > 0 ? Math.round((correctAnswers / totalAttempts) * 100) : 0;
            document.getElementById('final-stats').innerHTML = `
                <p>You've visited ${correctAnswers} out of ${totalProblems} islands!</p>
                <p>Your navigation accuracy: ${accuracyPercentage}%</p>
                <p>${getLuffyMessage(accuracyPercentage)}</p>
            `;
        }
        
        // Get Luffy's message based on accuracy
        function getLuffyMessage(accuracy) {
            if (accuracy >= 90) {
                return "\"You're definitely ready to be part of my crew!\" - Luffy";
            } else if (accuracy >= 70) {
                return "\"Not bad! You're getting closer to finding the One Piece!\" - Luffy";
            } else if (accuracy >= 50) {
                return "\"Keep practicing! That's how I got stronger too!\" - Luffy";
            } else {
                return "\"Don't give up! I never give up either!\" - Luffy";
            }
        }
        
        // Create the progress map with islands
        function createProgressMap() {
            const progressMap = document.getElementById('progress-map');
            const pathLine = document.getElementById('path-line');
            const mapWidth = progressMap.offsetWidth;
            
            // Set path line width
            pathLine.style.width = `${mapWidth - 60}px`;
            
            // Clear any existing islands
            const existingIslands = document.querySelectorAll('.island');
            existingIslands.forEach(island => island.remove());
            
            // Remove existing ship
            const existingShip = document.querySelector('.ship');
            if (existingShip) existingShip.remove();
            
            // Add islands
            const islandSpacing = (mapWidth - 60) / (totalProblems - 1);
            for (let i = 0; i < totalProblems; i++) {
                const island = document.createElement('div');
                island.className = 'island';
                island.id = `island-${i}`;
                island.style.left = `${30 + i * islandSpacing}px`;
                island.innerHTML = (i + 1).toString();
                progressMap.appendChild(island);
            }
            
            // Add ship
            const ship = document.createElement('div');
            ship.className = 'ship';
            ship.id = 'ship';
            ship.innerHTML = '‚õµ';
            ship.style.left = '10px'; // Start position
            progressMap.appendChild(ship);
        }
        
        // Update ship position
        function updateShipPosition(islandIndex) {
            const ship = document.getElementById('ship');
            if (!ship) return;
            
            if (islandIndex >= totalProblems) {
                // Move to the end position
                ship.style.left = `${document.getElementById('progress-map').offsetWidth - 50}px`;
            } else {
                const island = document.getElementById(`island-${islandIndex}`);
                if (island) {
                    const islandLeft = parseInt(island.style.left);
                    ship.style.left = `${islandLeft - 5}px`; // Center the ship on the island
                }
            }
        }
        
        // Start a new adventure
        function startNewAdventure() {
            currentProblemIndex = 0;
            correctAnswers = 0;
            totalAttempts = 0;
            
            // Reset display
            document.getElementById('correct-count').textContent = '0';
            document.getElementById('total-count').textContent = totalProblems;
            document.getElementById('accuracy').textContent = '0%';
            
            // Hide end screen if visible
            document.getElementById('end-screen').classList.remove('active');
            
            // Show question card
            document.getElementById('question-card').classList.remove('hidden');
            
            // Generate new problems
            generateAllProblems();
            
            // Create/reset progress map
            createProgressMap();
            
            // Update ship starting position
            updateShipPosition(0);
            
            // Display first problem
            displayProblem();
        }
        
        // Initialize the app when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Set up button event listeners
            document.getElementById('start-btn').addEventListener('click', startNewAdventure);
            document.getElementById('next-btn').addEventListener('click', nextProblem);
            document.getElementById('restart-btn').addEventListener('click', startNewAdventure);
            
            // Set total problems
            document.getElementById('total-count').textContent = totalProblems;
            
            // Handle window resize for progress map
            window.addEventListener('resize', function() {
                if (document.getElementById('progress-map').offsetWidth > 0) {
                    createProgressMap();
                    updateShipPosition(currentProblemIndex);
                }
            });
            
            // Start the adventure
            startNewAdventure();
        });
    </script>
</body>
</html>
